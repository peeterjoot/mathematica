(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13758,        396]
NotebookOptionsPosition[     12810,        372]
NotebookOutlinePosition[     13169,        388]
CellTagsIndexPosition[     13126,        385]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"<<", " ", "GA30`"}], ";"}]], "Input",
 CellChangeTimes->{{3.741601518808134*^9, 
  3.7416015496280212`*^9}},ExpressionUUID->"b3f180b5-5a1c-4a80-93be-\
861ed56168a3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "i", ",", "j", ",", "k", ",", "b1", ",", " ", "b2", ",", " ", "b3", ",", 
   "ej", ",", "x", ",", " ", "xr", ",", " ", "xt", ",", " ", "xp", ",", " ", 
   "r"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"i", "=", 
   RowBox[{"Bivector", "[", 
    RowBox[{"1", ",", "1", ",", " ", "2"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"k", " ", "=", " ", 
   RowBox[{"Bivector", "[", 
    RowBox[{"1", ",", "3", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b1", " ", "=", " ", 
   RowBox[{"Vector", "[", 
    RowBox[{"1", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b2", " ", "=", " ", 
   RowBox[{"Vector", "[", 
    RowBox[{"1", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b3", " ", "=", " ", 
   RowBox[{"Vector", "[", 
    RowBox[{"1", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"j", "[", "phi_", "]"}], "=", 
   RowBox[{"k", " ", "**", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", "phi", "]"}], "+", 
      RowBox[{"i", " ", 
       RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ej", "[", 
    RowBox[{"t_", ",", "p_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Cos", "[", "t", "]"}], "+", 
    RowBox[{
     RowBox[{"j", "[", "p", "]"}], " ", 
     RowBox[{"Sin", "[", "t", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"x", "[", 
     RowBox[{"r_", ",", "t_", ",", "p_"}], "]"}], "=", 
    RowBox[{"r", " ", 
     RowBox[{"(", 
      RowBox[{"b3", " ", "**", " ", 
       RowBox[{"ej", "[", 
        RowBox[{"t", ",", "p"}], "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xr", "[", 
    RowBox[{"r_", ",", "theta_", ",", "phi_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"a", ",", "theta", ",", "phi"}], "]"}], ",", "a"}], "]"}], "/.", 
    RowBox[{"a", "\[Rule]", "r"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"xt", "[", 
    RowBox[{"r_", ",", "theta_", ",", "phi_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"r", ",", "t", ",", "phi"}], "]"}], ",", "t"}], "]"}], "/.", 
    RowBox[{"t", "\[Rule]", "theta"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"xp", "[", 
     RowBox[{"r_", ",", "theta_", ",", "phi_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"r", ",", "theta", ",", "p"}], "]"}], ",", "p"}], "]"}], "/.", 
     RowBox[{"p", "\[Rule]", "phi"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x", "[", 
     RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"xr", "[", 
     RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"xt", "[", 
     RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"xp", "[", 
     RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}]}], "}"}], 
  " ", "//", " ", "Column"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.741601607508554*^9, 3.7416018025678473`*^9}, {
   3.7416018429739428`*^9, 3.7416018604112377`*^9}, {3.741601988590494*^9, 
   3.741602017600346*^9}, 3.7416020630485363`*^9, {3.741602166345851*^9, 
   3.741602166672639*^9}, {3.741602202890403*^9, 3.741602209064556*^9}, {
   3.7416023348277807`*^9, 3.7416023544097013`*^9}, {3.741602459577527*^9, 
   3.74160245976731*^9}, {3.741602515057423*^9, 
   3.741602522590705*^9}},ExpressionUUID->"c4b2b14d-c8ba-4c67-9510-\
cde5876a164c"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{
      RowBox[{"r", " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       SubscriptBox[
        StyleBox["\<\"e\"\>",
         StripOnInput->False,
         FontWeight->Bold], "1"]}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
       SubscriptBox[
        StyleBox["\<\"e\"\>",
         StripOnInput->False,
         FontWeight->Bold], "2"]}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       SubscriptBox[
        StyleBox["\<\"e\"\>",
         StripOnInput->False,
         FontWeight->Bold], "3"]}]}]},
    {
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       SubscriptBox[
        StyleBox["\<\"e\"\>",
         StripOnInput->False,
         FontWeight->Bold], "1"]}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
       SubscriptBox[
        StyleBox["\<\"e\"\>",
         StripOnInput->False,
         FontWeight->Bold], "2"]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       SubscriptBox[
        StyleBox["\<\"e\"\>",
         StripOnInput->False,
         FontWeight->Bold], "3"]}]}]},
    {
     RowBox[{
      RowBox[{"r", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       SubscriptBox[
        StyleBox["\<\"e\"\>",
         StripOnInput->False,
         FontWeight->Bold], "1"]}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
       SubscriptBox[
        StyleBox["\<\"e\"\>",
         StripOnInput->False,
         FontWeight->Bold], "2"]}], "-", 
      RowBox[{"r", " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       SubscriptBox[
        StyleBox["\<\"e\"\>",
         StripOnInput->False,
         FontWeight->Bold], "3"]}]}]},
    {
     RowBox[{
      RowBox[{
       RowBox[{"-", "r"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
       SubscriptBox[
        StyleBox["\<\"e\"\>",
         StripOnInput->False,
         FontWeight->Bold], "1"]}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       SubscriptBox[
        StyleBox["\<\"e\"\>",
         StripOnInput->False,
         FontWeight->Bold], "2"]}]}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{
  3.741601622554163*^9, {3.741601663568454*^9, 3.7416016883900557`*^9}, {
   3.7416017185296497`*^9, 3.741601767900717*^9}, 3.741601803810034*^9, {
   3.741601851700139*^9, 3.741601861136465*^9}, {3.741602003060573*^9, 
   3.7416020204390497`*^9}, 3.741602064086316*^9, 3.741602212785321*^9, {
   3.7416024340195513`*^9, 3.741602460923233*^9}, 
   3.74160252387112*^9},ExpressionUUID->"1f83df9e-6f9e-46c6-9585-\
f629610d2be1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"xr", "[", 
     RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}], " ", "**",
     "\[IndentingNewLine]", 
    RowBox[{"xt", "[", 
     RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}], " ", "**",
     "\[IndentingNewLine]", 
    RowBox[{"xp", "[", 
     RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"e1", ",", "e2", ",", "e3"}], "}"}], " ", "=", " ", 
     RowBox[{"IdentityMatrix", "[", "3", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "probably", " ", "a", " ", "better", " ", "way", " ", "to", " ", "do", 
     " ", "this", " ", "with", " ", "Map", " ", "or", " ", "MapThread"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"jacobean", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"xr", "[", 
           RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}], 
          " ", ".", " ", "b1"}], ",", 
         RowBox[{
          RowBox[{"xr", "[", 
           RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}], 
          " ", ".", " ", "b2"}], ",", 
         RowBox[{
          RowBox[{"xr", "[", 
           RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}], 
          " ", ".", " ", "b3"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"xt", "[", 
           RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}], 
          " ", ".", " ", "b1"}], ",", 
         RowBox[{
          RowBox[{"xt", "[", 
           RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}], 
          " ", ".", " ", "b2"}], ",", 
         RowBox[{
          RowBox[{"xt", "[", 
           RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}], 
          " ", ".", " ", "b3"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"xp", "[", 
           RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}], 
          " ", ".", " ", "b1"}], ",", 
         RowBox[{
          RowBox[{"xp", "[", 
           RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}], 
          " ", ".", " ", "b2"}], ",", 
         RowBox[{
          RowBox[{"xp", "[", 
           RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "]"}], 
          " ", ".", " ", "b3"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Det", "[", "  ", "jacobean", " ", "]"}], " ", "//", " ", 
    "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.741602090535902*^9, 3.741602151717162*^9}, {
   3.741602219643614*^9, 3.7416022904783373`*^9}, {3.7416023624148073`*^9, 
   3.741602429379867*^9}, {3.741602469924552*^9, 3.7416024972529984`*^9}, 
   3.741602554348773*^9, {3.7416025876064157`*^9, 
   3.741602603197151*^9}},ExpressionUUID->"b06c1502-592d-4010-88bd-\
d302f817c363"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["r", "2"], " ", 
  RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
  SubscriptBox[
   StyleBox["\<\"e\"\>",
    StripOnInput->False,
    FontWeight->Bold], "\<\"123\"\>"]}]], "Output",
 CellChangeTimes->{
  3.7416021097971992`*^9, 3.741602220323718*^9, {3.741602267741273*^9, 
   3.741602291410858*^9}, 3.741602430441921*^9, {3.741602477021346*^9, 
   3.741602489495419*^9}, 
   3.741602555262092*^9},ExpressionUUID->"e30e971e-d47a-4365-8318-\
417b51c8d536"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["r", "2"], " ", 
  RowBox[{"Sin", "[", "\[Theta]", "]"}]}]], "Output",
 CellChangeTimes->{
  3.7416021097971992`*^9, 3.741602220323718*^9, {3.741602267741273*^9, 
   3.741602291410858*^9}, 3.741602430441921*^9, {3.741602477021346*^9, 
   3.741602489495419*^9}, 
   3.7416025552823267`*^9},ExpressionUUID->"d41a88c5-a07d-46d6-948b-\
0b9dc4cf06a0"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"a", ",", "b", ",", "c", ",", "e", ",", "f", ",", "g"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Map", "[", 
    RowBox[{"foo", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"e", ",", "f", ",", "g"}], "}"}]}], "}"}], ",", " ", "1"}], 
    "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.741602920671706*^9, 3.741603017795927*^9}, {
   3.741603079621076*^9, 3.741603094931131*^9}, 
   3.741603718248605*^9},ExpressionUUID->"20cfd871-999d-4f5e-a2cc-\
ced1c5ef42d3"]
},
WindowSize->{1154, 1170},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 200, 5, 30, "Input",ExpressionUUID->"b3f180b5-5a1c-4a80-93be-861ed56168a3"],
Cell[CellGroupData[{
Cell[783, 29, 3903, 111, 409, "Input",ExpressionUUID->"c4b2b14d-c8ba-4c67-9510-cde5876a164c"],
Cell[4689, 142, 3321, 97, 87, "Output",ExpressionUUID->"1f83df9e-6f9e-46c6-9585-f629610d2be1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8047, 244, 3194, 79, 283, "Input",ExpressionUUID->"b06c1502-592d-4010-88bd-d302f817c363"],
Cell[11244, 325, 496, 13, 34, "Output",ExpressionUUID->"e30e971e-d47a-4365-8318-417b51c8d536"],
Cell[11743, 340, 387, 9, 34, "Output",ExpressionUUID->"d41a88c5-a07d-46d6-948b-0b9dc4cf06a0"]
}, Open  ]],
Cell[12145, 352, 661, 18, 86, "Input",ExpressionUUID->"20cfd871-999d-4f5e-a2cc-ced1c5ef42d3"]
}
]
*)

